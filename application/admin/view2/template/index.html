<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>开启头部工具栏 - 数据表格</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/admin.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/public.css">
    <script src="__PUBLIC__/layuiadmin/js/public.js"></script>
    <style>
        .list {
            overflow: hidden;
        }

        .list>li {
            float: left;
            margin:0 15px 15px 0;
            border: 1px solid #ccc;
        }

        .img-div {
            height: 500px;
            overflow: hidden;
        }

        .layui-form-radio>i {
            font-size: 14px;
            margin-right: 2px;
        }

        .layui-form-radio {
            margin: 6px 0 0 0;
            padding-right: 2px;
        }

        .layui-form-radioed>div {
            color: red;
        }
    </style>
</head>

<body>

<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header1">模板列表</div>
                <div class="layui-card-body">
                    <ul class="list">
                        {volist name="template_list" id="voo"}
                        {php} $temp=$key;{/php}
                        {volist name="voo" id="vo"}
                        {if condition="($key eq 0 && substr($selcode,0,strrpos($selcode,'_')) neq $vo['dirname'] ) OR (strtolower($vo['dirname']) eq strtolower($selcode) )"}
                        <li>
                            <div class="template-show">
                                <div class="img-div">
                                    {if condition="substr($vo['dirname'],0,strrpos($vo['dirname'],'_')) eq ''"}

                                    <a href="/template/{$vo.dirname}/index.jpg" title="点击查看" target="_blank" temp="" pictype="">
                                        <img src="/template/{$vo.dirname}/index.jpg" alt=""
                                             width="200"></a>
                                    {else /}
                                    <a href="/template/{:substr($vo['dirname'],0,strrpos($vo['dirname'],'_'))}/index{:substr($vo['dirname'], -2)}.jpg" title="点击查看" target="_blank" temp="" pictype="">
                                        <img style="width:200px; " src="/template/{:substr($vo['dirname'],0,strrpos($vo['dirname'],'_'))}/index{:substr($vo['dirname'], -2)}.jpg" alt="" /></a>{/if}
                                </div>
                                <form class="layui-form" action="">
                                    <div class="layui-form-item" style="margin-bottom: 0;">
                                        <label class="layui-form-label" style="width: auto; padding: 9px 6px;">{$vo.temname}</label>
                                        <div class="layui-input-block" style="margin-left: 0">
                                            <input type="radio" name="code" value="{$temp}" title="小图"
                                                   {if condition="substr($selcode,0,strrpos($selcode,'_')) =='' && strtolower($vo['dirname']) eq strtolower($selcode)"}checked{/if} temp="{$temp}/index.jpg"  lay-filter="component-form-group" />
                                            <input type="radio" name="code" value="{$temp}_m" title="中图" {if condition="substr($selcode, -1) eq 'm' && strtolower($vo['dirname']) eq strtolower($selcode)"} checked{/if} temp="{$temp}/index_m.jpg" lay-filter="component-form-group" />
                                            <input type="radio" name="code" value="{$temp}_b" title="大图"  {if condition="substr($selcode, -1) eq 'b' && strtolower($vo['dirname']) eq strtolower($selcode)"}checked{/if} temp="{$temp}/index_b.jpg" lay-filter="component-form-group" />
                                        </div>
                                    </div>

                                    <div style="margin-bottom: 10px; text-align: center; color: red;height:25px">
                                        {if condition="strtolower($vo['dirname']) eq strtolower($selcode)"}
                                        已启用 <span>
                                        {if condition="substr($selcode, -1) eq 'm'"}中图
                                                                {elseif condition="substr($selcode, -1) eq 'b'"}大图
                                                                {else}小图
                                                            {/if}
                                    </span>
                                        {/if}
                                    </div>

                                </form>

                            </div>
                        </li>
                        {/if}
                        {/volist}
                        {/volist}

                    </ul>
                </div>
                <div id="laypage" style="text-align: right; margin-right: 15px;"></div>

            </div>
        </div>
    </div>



</div>

<script src="/layuiadmin/layui/layui.js"></script>
<script>
    layui.config({
        base: '/layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'form','table'], function () {
        var $ = layui.$
            , admin = layui.admin
            , element = layui.element
            , form = layui.form
            ,laypage = layui.laypage

        form.render(null, 'component-form-element');
        element.render('breadcrumb', 'breadcrumb');

        form.on('submit(component-form-element)', function (data) {
            layer.msg(JSON.stringify(data.field));
            return false;
        });
        form.on('radio(component-form-group)', function(data){
            // console.log(data.elem); //得到radio原始DOM对象
            // console.log(data.value); //被点击的radio的value值
            var code=data.value;
            window.location="{:url('template/changetemplate')}?code="+code
        });
        //总页数大于页码总数
        laypage.render({
            elem: 'laypage'
            ,count: {:$page->count}
    ,curr: {:$page->iPage}
    ,limit: {:$page->pageSize}
    ,layout: ['count', 'prev', 'page', 'next', 'skip']
            ,jump: function(obj){
            if(obj.curr!= "{:$page->iPage}"){
                var jumpUrl = "{:$page->url('currentPage')}";
                jumpUrl = jumpUrl.replace("currentPage",obj.curr);
                location.href = jumpUrl;
            }
        }
    });


    });


    $(document).on('mouseover', '.layui-form-radio', function () {
        obj=$(this)
        var temp=obj.prev().attr('temp')
        //console.log(temp)
        obj.parents('.template-show').eq(0).find('.img-div').eq(0).find('a').eq(0).attr('href', '/template/'+temp)
        obj.parents('.template-show').eq(0).find('.img-div').eq(0).find('img').eq(0).attr('src', '/template/'+temp)
    })

</script>
</body>

